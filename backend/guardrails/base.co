# This file defines the logic for the rails activated in config.yml.

define flow self check input
  # This uses the self_check_input task from prompt.yml to validate the user's message.
  # The prompt asks "Should the user message be blocked?". "SÃ­" is True, "No" is False.
  $should_block = execute self_check_input(user_input=$last_user_message)

  # If the message should be blocked, the bot will refuse to respond.
  if $should_block
    bot refuse to respond
  else
    return

# This flow is triggered by the output rail configuration.
define flow self check output
  # The `self_check_output` task is defined in prompts.yml.
  # It will be executed against the last bot message and the conversation context.
  $should_block = execute self_check_output(bot_response=$last_bot_message, conversation_context=$conversation_context)
  if $should_block
    bot refuse to respond
  else
    return

# This flow checks if the bot's last message contains any forbidden words.
# define flow check for forbidden words
  # The `check_forbidden_words` action is a built-in action.
  # It returns `True` if no forbidden words are found, and `False` otherwise.

  # If the message is allowed (does not contain forbidden words), we continue.
  # Otherwise, we stop the interaction.
#   if $is_allowed
#     return
#   else
#     bot refuse to respond